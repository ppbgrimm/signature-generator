<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B.Grimm Signature Generator</title>
    <style>
        /* --- GLOBAL SETTINGS (MASTER STYLE) --- */
        :root {
            --body-side-padding: 20px;
            --logo-min-h: 30px;
            --logo-pref-h: 5vw;
            --logo-max-h: 50px;
            --primary-orange: #FF6727;
            --gold-theme: #8C704D;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 140px; 
            padding-bottom: 30px;
            padding-left: var(--body-side-padding);
            padding-right: var(--body-side-padding);
            color: #63666F;
            min-height: 100vh;
            box-sizing: border-box;
            transition: background-color 0.5s;
        }
        
        input, button, .tab-btn, h1, h2, h3, h4, .sub-header, li, p {
            font-family: Arial, sans-serif;
        }

        /* --- HEADER --- */
        .main-header {
            position: fixed; z-index: 2000; left: 0; right: 0; margin: 0 auto;
            top: 0; width: 100%; border-radius: 0; padding: 20px 0;
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-sizing: border-box; display: flex; justify-content: center;
        }
        .main-header.scrolled {
            top: 20px; width: 95%; max-width: 1140px; border-radius: 60px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 15px 40px rgba(31, 38, 135, 0.12);
            background: rgba(255, 255, 255, 0.9); padding: 10px 0;
        }
        .header-inner { width: 100%; max-width: 1100px; padding: 0 30px; display: flex; justify-content: space-between; align-items: center; }
        .header-logo img { height: clamp(var(--logo-min-h), var(--logo-pref-h), var(--logo-max-h)); width: auto; display: block; transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .main-header.scrolled .header-logo img { height: clamp(25px, 4vw, 35px); }
        .header-titles { text-align: right; transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        
        .header-title-en {
            font-size: clamp(14px, 2.5vw, 26px); font-weight: 700; margin-bottom: 2px; letter-spacing: -0.5px;
            background: linear-gradient(120deg, #FF6727 0%, #FF8C00 15%, #FF6727 30%, #FFE3B3 45%, #FF6727 60%, #FF4500 75%, #FF6727 90%);
            background-size: 400% 400%; color: #FF6727; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
            animation: moltenChaos 25s ease infinite; transition: font-size 0.6s var(--elastic-bezier);
        }
        .header-title-th { font-size: clamp(10px, 1.5vw, 16px); color: #63666F; transition: font-size 0.6s var(--elastic-bezier); }
        .main-header.scrolled .header-title-en { font-size: clamp(12px, 2vw, 18px); }
        .main-header.scrolled .header-title-th { font-size: clamp(9px, 1.2vw, 12px); opacity: 0.8; }
        @keyframes moltenChaos { 0% { background-position: 10% 15%; } 50% { background-position: 15% 60%; } 100% { background-position: 10% 15%; } }

        /* --- CONTAINER --- */
        .container { display: flex; gap: 30px; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 1100px; flex-wrap: wrap; margin-bottom: 40px; margin-top: 0; }
        .input-section { flex: 1; min-width: 320px; border-right: 1px solid #ddd; padding-right: 30px; }
        .preview-section { flex: 1.5; min-width: 320px; display: flex; flex-direction: column; }
        h2 { margin: 0; color: #8C704D; font-size: 22px; margin-bottom: 5px; }
        .sub-header { color: #777; font-size: 14px; margin-bottom: 20px; font-weight: 400; }
        .input-section h3 { margin: 15px 0 10px; font-size: 15px; color: #8C704D; border-bottom: 1px solid #eee; padding-bottom: 5px; font-weight: 700; }

        /* --- INPUTS --- */
        .form-group { margin-bottom: 15px; position: relative; }
        label { display: block; margin-bottom: 5px; font-weight: 700; font-size: 13px; color: #666; }
        input { width: 100%; padding: 10px; padding-right: 35px; border: 1px solid #ccc; border-radius: 8px; font-size: 14px; box-sizing: border-box; transition: all 0.3s ease; color: #63666F; }
        input:focus { border-color: #C8B273; box-shadow: 0 0 0 3px rgba(200, 178, 115, 0.2); outline: none; }
        input.input-error { border-color: #dc3545 !important; background-color: #fff8f8; }
        
        /* Standard Placeholder */
        ::placeholder { color: #a8a8a8; opacity: 1; }
        
        .valid-icon { position: absolute; right: 12px; top: 32px; color: #28a745; font-size: 16px; display: none; pointer-events: none; font-weight: bold; }
        .format-hint { font-size: 11px; color: #888; margin-top: 2px; }

        /* === ANIMATION SYSTEM === */
        .anim-wrapper {
            position: absolute; top: 32px; left: 11px; pointer-events: none; width: 85%; height: 20px; overflow: hidden; z-index: 5;
        }
        .anim-wrapper.warning-mode {
            position: relative; top: 0; left: 0; width: 100%; margin-top: 4px; display: none;
        }
        
        .anim-wrapper span {
            position: absolute; top: 0; left: 0; width: 100%; white-space: nowrap;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: Arial, sans-serif;
        }

        /* Placeholder Style */
        .custom-placeholder span { font-size: 14px; color: #a8a8a8; }
        /* Warning Style */
        .warning-msg span { font-size: 12px; color: #dc3545; font-weight: 700; }
        
        /* GLOBAL STATE CONTROL */
        body[data-lang-state="th"] .anim-wrapper .th { opacity: 1; transform: translateY(0); }
        body[data-lang-state="th"] .anim-wrapper .en { opacity: 0; transform: translateY(10px); }
        
        body[data-lang-state="en"] .anim-wrapper .th { opacity: 0; transform: translateY(-10px); }
        body[data-lang-state="en"] .anim-wrapper .en { opacity: 1; transform: translateY(0); }

        /* Bubble Text */
        .bubble-text-wrapper { display: inline-block; white-space: nowrap; overflow: hidden; width: 85px; position: relative; height: 20px; }
        .bubble-text-wrapper span { position: absolute; top: 0; left: 0; transition: all 0.6s ease; }

        /* --- TABS --- */
        .toggle-container { position: relative; display: flex; background: #f5f5f5; padding: 6px; border-radius: 12px; margin-bottom: 25px; }
        .tab-btn { flex: 1; text-align: center; padding: 10px; cursor: pointer; border-radius: 8px; margin: 0; font-size: 14px; color: #666; font-weight: 400 !important; border: 1px solid transparent; background: transparent; z-index: 2; position: relative; transition: color 0.3s ease; }
        .tab-btn.active { color: white; }
        .tab-slider { position: absolute; top: 6px; left: 6px; bottom: 6px; background-color: #8C704D; border-radius: 8px; z-index: 1; transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); width: 0; }

        /* --- PREVIEW BOX --- */
        .signature-box { border: 2px dashed #ccc; padding: 20px; margin-top: 10px; border-radius: 12px; background: #fff; min-height: 200px; }
        .mobile-preview-container { max-width: 320px; margin: 0 auto; border: 1px solid #eee; padding: 20px; background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.05); white-space: pre-wrap; font-family: Arial, sans-serif; }
        .btn-copy { background: linear-gradient(180deg, #997b55 0%, #8C704D 100%); color: white; border: none; padding: 14px 24px; border-radius: 50px; font-size: 15px; cursor: pointer; font-weight: 700; margin-top: 20px; width: 100%; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 4px 6px rgba(140, 112, 77, 0.2); transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); position: relative; overflow: hidden; }
        .btn-copy:hover { transform: translateY(-2px); background: linear-gradient(180deg, #a3845c 0%, #967853 100%); box-shadow: 0 8px 15px rgba(140, 112, 77, 0.35); }
        .btn-copy:active { transform: translateY(1px) scale(0.98); box-shadow: 0 2px 4px rgba(140, 112, 77, 0.2); }
        .btn-copy::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(255,255,255,0.1), rgba(255,255,255,0)); opacity: 0; transition: opacity 0.2s; }
        .btn-copy:hover::after { opacity: 1; }
        
        .note { font-size: 12px; color: #666; margin-top: 10px; background: #fff3cd; padding: 10px; border-radius: 4px; text-align: center; }
        .form-container { display: none; }
        .form-container.active { display: block; animation: fadeIn 0.5s cubic-bezier(0.25, 0.8, 0.25, 1); }
        #contactSection { animation: fadeIn 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); }
        #previewDesktop, #previewMobile { display: none; }
        #previewDesktop.active, #previewMobile.active { display: block; animation: fadeIn 0.5s cubic-bezier(0.25, 0.8, 0.25, 1); }

        /* --- FLOAT BTN --- */
        .float-guide-btn { position: fixed; bottom: 30px; right: 30px; background: linear-gradient(135deg, #8C704D 0%, #C8B273 100%); color: white; border: none; border-radius: 50px; padding: 12px 20px; font-weight: 700; font-size: 14px; box-shadow: 0 6px 20px rgba(140, 112, 77, 0.4); cursor: pointer; z-index: 1000; display: flex; align-items: center; justify-content: center; gap: 10px; animation: floatBounce 3s infinite ease-in-out; transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); opacity: 1; visibility: visible; transform: translateY(0); }
        .float-guide-btn.hidden { opacity: 0; visibility: hidden; transform: translateY(20px); pointer-events: none; animation: none; }
        .float-guide-btn:hover { transform: scale(1.05); animation-play-state: paused; }
        .icon-bubble { font-size: 18px; background: rgba(255,255,255,0.2); border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        @keyframes floatBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        .guide-container { width: 100%; max-width: 1100px; display: flex; flex-direction: column; gap: 10px; scroll-margin-top: 20px; }
        .guide-header-row { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 1100px; margin-bottom: 20px; border-bottom: 2px solid #C8B273; padding-bottom: 10px; scroll-margin-top: 40px; }
        .guide-section-title { color: #8C704D; font-size: 20px; font-weight: 700; margin: 0; }
        .accordion { background-color: #fff; color: #63666F; cursor: pointer; padding: 18px 25px; width: 100%; border: 1px solid #e0e0e0; text-align: left; outline: none; font-size: 16px; font-weight: 700; transition: all 0.3s ease; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .accordion:hover { color: #8C704D; border-color: #C8B273; background-color: #fffbf5; transform: translateY(-1px); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .accordion.active { background-color: #fff; color: #8C704D; border-color: #8C704D; border-bottom-left-radius: 0; border-bottom-right-radius: 0; box-shadow: 0 4px 10px rgba(140, 112, 77, 0.1); }
        .accordion .icon { font-size: 12px; color: #989AA5; transition: transform 0.3s ease; }
        .accordion.active .icon { transform: rotate(180deg); color: #8C704D; }
        .panel { padding: 0 25px; background-color: #fff; max-height: 0; overflow: hidden; border: 1px solid #8C704D; border-top: none; border-radius: 0 0 10px 10px; margin-top: -10px; margin-bottom: 5px; opacity: 0; transform: translateY(-5px); transition: all 0.3s ease; }
        .panel.show { padding: 25px; max-height: 1000px; opacity: 1; transform: translateY(0); margin-bottom: 15px; }
        .panel h4 { color: #8C704D; margin: 15px 0 5px; font-size: 15px; }
        .panel p { font-size: 14px; color: #63666F; line-height: 1.6; margin-bottom: 10px; }
        .panel ul, .panel ol { padding-left: 20px; color: #63666F; font-size: 14px; line-height: 1.8; }
        .panel li { margin-bottom: 5px; }
        .panel code { background: #f5f5f5; padding: 2px 6px; border-radius: 4px; color: #63666F; font-family: monospace; border: 1px solid #989AA5; }
        .panel em { color: #989AA5; font-size: 13px; font-style: italic; }
        .lang-switch { display: flex; gap: 10px; font-size: 14px; font-weight: 700; }
        .lang-btn { cursor: pointer; color: #989AA5; transition: color 0.2s; }
        .lang-btn:hover { color: #C8B273; }
        .lang-btn.active { color: #8C704D; text-decoration: underline; }
        .lang-divider { color: #C8B273; }
        [data-lang="th"] { display: block; } [data-lang="en"] { display: none; }

        .app-footer { margin-top: 30px; color: #989AA5; font-size: 13px; text-align: center; padding-bottom: 20px; width: 100%; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) { .container { flex-direction: column; } .input-section { border-right: none; padding-right: 0; border-bottom: 1px solid #ddd; padding-bottom: 20px; } .float-guide-btn { bottom: 20px; right: 20px; padding: 10px 20px; font-size: 12px; } .header-titles { text-align: left; } }
    </style>
</head>
<body data-lang-state="th">

<header class="main-header" id="stickyHeader">
    <div class="header-inner">
        <div class="header-logo"><img src="https://static-portal.bgrimm.io/public/logo/B.Grimm%20Logo.png" alt="B.Grimm Logo"></div>
        <div class="header-titles">
            <div class="header-title-en">Email Signature Generator</div>
            <div class="header-title-th">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
        </div>
    </div>
</header>

<button id="floatGuideBtn" class="float-guide-btn" onclick="scrollToGuide()">
    <span class="icon-bubble">?</span> 
    <div class="anim-wrapper bubble-text-wrapper">
        <span class="th">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á?</span><span class="en">How to install?</span>
    </div>
</button>

<div class="container">
    <div class="input-section">
        <h2>Enter Information</h2>
        <div class="sub-header">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
        <div class="toggle-container" id="modeSelector">
            <div class="tab-slider" id="modeSlider"></div>
            <button class="tab-btn active" onclick="setMode('person', this)">üë§ ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
            <button class="tab-btn" onclick="setMode('dept', this)">üè¢ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</button>
        </div>

        <div id="formPerson" class="form-container active">
            <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (Personal Info)</h3>
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Name - EN)</label>
                <input type="text" id="pNameEng" placeholder="Somchai Jaidee" oninput="updateSig()">
                <span id="checkNameEng" class="valid-icon">‚úì</span>
                <div class="anim-wrapper warning-msg warning-mode" id="warnNameEng"></div>
            </div>
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (Name - TH)</label>
                <input type="text" id="pNameTh" placeholder="‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" oninput="updateSig()">
                <span id="checkNameTh" class="valid-icon">‚úì</span>
                <div class="anim-wrapper warning-msg warning-mode" id="warnNameTh"></div>
            </div>
            
            <h3>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô (Job Details)</h3>
            <div class="form-group">
                <label>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (Position)</label>
                <input type="text" id="pPosition" oninput="checkPh(this); updateSig();">
                <div class="anim-wrapper custom-placeholder" id="ph_pPosition"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
                <div class="anim-wrapper warning-msg warning-mode" id="warnPos">
                    <span class="th">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô</span><span class="en">‚ö†Ô∏è Please fill in job title</span>
                </div>
            </div>
            <div class="form-group">
                <label>‡πÅ‡∏ú‡∏ô‡∏Å/‡∏™‡πà‡∏ß‡∏ô‡∏á‡∏≤‡∏ô (Section/Solutions)</label>
                <input type="text" id="pSection" oninput="checkPh(this); updateSig();">
                <div class="anim-wrapper custom-placeholder" id="ph_pSection"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
            </div>
            <div class="form-group">
                <label>‡∏ù‡πà‡∏≤‡∏¢ (Department)</label>
                <input type="text" id="pDepartment" oninput="checkPh(this); updateSig();">
                <div class="anim-wrapper custom-placeholder" id="ph_pDepartment"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
            </div>
        </div>

        <div id="formDept" class="form-container">
            <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (Department Info)</h3>
            <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Dept Name - EN)</label>
                <input type="text" id="dNameEng" placeholder="Human Resources" oninput="updateSig()">
                <span id="checkDeptEng" class="valid-icon">‚úì</span><div class="anim-wrapper warning-msg warning-mode" id="warnDeptEng"></div>
            </div>
            <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (Dept Name - TH)</label>
                <input type="text" id="dNameTh" oninput="checkPh(this); updateSig()">
                <div class="anim-wrapper custom-placeholder" id="ph_dNameTh"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
                <span id="checkDeptTh" class="valid-icon">‚úì</span><div class="anim-wrapper warning-msg warning-mode" id="warnDeptTh"></div>
            </div>
        </div>

        <div id="contactSection">
            <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (Contact Info)</h3>
            <div class="form-group"><label>‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Email)</label>
                <input type="email" id="inputEmail" placeholder="example@bgrimmpower.com" oninput="updateSig()">
                <span id="checkEmail" class="valid-icon">‚úì</span><div class="anim-wrapper warning-msg warning-mode" id="warnEmail"></div>
            </div>
            <div class="form-group">
                <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (Mobile)</label>
                <input type="text" id="inputMobile" maxlength="10" oninput="checkPh(this); updateSig()">
                <div class="anim-wrapper custom-placeholder" id="ph_inputMobile"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
                <span id="checkMobile" class="valid-icon">‚úì</span>
                <div class="format-hint">‡∏û‡∏¥‡∏°‡∏û‡πå 10 ‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ç‡∏µ‡∏î)</div>
                <div class="anim-wrapper warning-msg warning-mode" id="warnMobile"></div>
            </div>
            <div class="form-group">
                <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (Telephone)</label>
                <input type="text" id="inputTel" maxlength="9" oninput="checkPh(this); updateSig()">
                <div class="anim-wrapper custom-placeholder" id="ph_inputTel"><span class="th">‡∏ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏ã‡πà‡∏≠‡∏ô</span><span class="en">Hidden if empty</span></div>
                <span id="checkTel" class="valid-icon">‚úì</span>
                <div class="format-hint">‡∏û‡∏¥‡∏°‡∏û‡πå 9 ‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ç‡∏µ‡∏î)</div>
                <div class="anim-wrapper warning-msg warning-mode" id="warnTel"></div>
            </div>
        </div>
    </div>

    <div class="preview-section">
        <h2>Select Template & Copy</h2>
        <div class="sub-header">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</div>
        <div class="toggle-container preview-tabs" id="previewTabs">
            <div class="tab-slider" id="previewSlider"></div>
            <button class="tab-btn active" onclick="switchTab('desktop', this)">üíª Desktop</button>
            <button class="tab-btn" onclick="switchTab('mobile', this)">üì± Mobile</button>
        </div>

        <div class="signature-box" id="signatureBox">
            <div id="previewDesktop" class="active">
                <style> a.sig-link { color:#63666F; text-decoration:none; } a.sig-link:hover{text-decoration:underline;color:#FF6727;} </style>
                <div style="font-family:Arial, sans-serif; font-size:12px; color:#63666F; margin-bottom: 10px;">--</div>
                <table cellpadding="0" cellspacing="0" border="0" style="font-family:Arial, sans-serif; font-size:12px; color:#63666F; line-height: 1.4;">
                  <tr><td style="padding-bottom:12px;"><img src="https://static-portal.bgrimm.io/public/logo/B.Grimm%20Logo.png" width="120" alt="B.Grimm Logo" border="0" style="display:block;"></td></tr>
                  <tr><td style="padding-bottom:2px;"><strong id="sigNameContent" style="font-size:12px; color:#FF6727;"></strong></td></tr>
                  <tr id="rowPosition"><td style="padding-bottom:2px;"><span id="prevPos"></span></td></tr>
                  <tr><td style="padding-bottom:2px;"><strong style="color:#63666F;">B.Grimm Power PCL</strong> <span style="color:#63666F;">|</span> Dr. Gerhard Link Building, 5 Krungthepkreetha Road, Bangkok 10240, Thailand</td></tr>
                  <tr id="rowPhones"><td style="padding-bottom:2px;"><span id="wrapMob"><strong>Mobile</strong> <a id="linkMobile" href="#" class="sig-link"></a></span><span id="wrapTel"></span></td></tr>
                  <tr><td><strong>Email</strong> <a id="linkEmail" href="#" class="sig-link"></a> <span style="color:#63666F;">|</span> <a href="https://www.bgrimmpower.com" class="sig-link">www.bgrimmpower.com</a></td></tr>
                </table>
            </div>
            <div id="previewMobile">
                <div class="mobile-preview-container" id="mobContent">Loading...</div>
            </div>
        </div>
        <button class="btn-copy" onclick="copySignature()">Copy to Clipboard</button>
        <div class="note"><span id="noteText"><strong>Desktop:</strong> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Outlook ‡∏ö‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</span></div>
    </div>
</div>

<div class="guide-header-row" id="guide-anchor">
    <h2 class="guide-section-title" id="guideTitle">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Installation Guide)</h2>
    <div class="lang-switch">
        <span class="lang-btn active" id="btnTh" onclick="setGuideLang('th')">TH</span><span class="lang-divider">|</span><span class="lang-btn" id="btnEn" onclick="setGuideLang('en')">EN</span>
    </div>
</div>

<div class="guide-container">
    <button class="accordion" id="acc-item-1"><span data-lang="th">1. Microsoft Outlook (Desktop App)</span><span data-lang="en">1. Microsoft Outlook (Desktop App)</span><span class="icon">‚ñº</span></button>
    <div class="panel">
        <div data-lang="th"><h4>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö New Outlook</h4><ol><li>‡∏Ñ‡∏•‡∏¥‡∏Å Settings ‚öôÔ∏è > Accounts > Signatures</li><li>+ New Signature ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ "B.Grimm"</li><li>‡∏ß‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô (Ctrl+V) ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Default > Save</li></ol><h4>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Classic Outlook</h4><ol><li>File > Options > Mail > Signatures</li><li>New > ‡∏ß‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô > ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Default > OK</li></ol></div>
        <div data-lang="en"><h4>For New Outlook</h4><ol><li>Settings ‚öôÔ∏è > Accounts > Signatures</li><li>+ New > Paste > Set Default > Save</li></ol></div>
    </div>
    <button class="accordion"><span data-lang="th">2. Outlook on the Web</span><span data-lang="en">2. Outlook on the Web</span><span class="icon">‚ñº</span></button>
    <div class="panel"><div data-lang="th"><ol><li>Settings ‚öôÔ∏è > Mail > Compose and reply</li><li>+ New signature > ‡∏ß‡∏≤‡∏á > ‡∏ï‡∏±‡πâ‡∏á Default > Save</li></ol></div><div data-lang="en"><ol><li>Settings ‚öôÔ∏è > Mail > Compose and reply</li><li>New > Paste > Set Default > Save</li></ol></div></div>
    <button class="accordion"><span data-lang="th">3. Google Workspace (Gmail)</span><span data-lang="en">3. Google Workspace (Gmail)</span><span class="icon">‚ñº</span></button>
    <div class="panel"><div data-lang="th"><ol><li>Settings ‚öôÔ∏è > See all settings</li><li>Signature > + Create new > ‡∏ß‡∏≤‡∏á</li><li>Signature defaults > Save Changes</li></ol></div><div data-lang="en"><ol><li>Settings ‚öôÔ∏è > All settings > Signature</li><li>Create > Paste > Set Defaults > Save</li></ol></div></div>
    <button class="accordion"><span data-lang="th">4. Mobile (Outlook App)</span><span data-lang="en">4. Mobile (Outlook App)</span><span class="icon">‚ñº</span></button>
    <div class="panel"><div data-lang="th"><ol><li>‡πÅ‡∏ï‡∏∞‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå > Settings ‚öôÔ∏è</li><li>Signature > ‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤ > ‡∏Å‡∏î‡∏ß‡∏≤‡∏á (Paste)</li></ol></div><div data-lang="en"><ol><li>Profile > Settings ‚öôÔ∏è > Signature</li><li>Paste signature > Save</li></ol></div></div>
</div>

<footer class="app-footer">¬© 2026 B.Grimm, Digital and Energy Solutions</footer>

<script>
    /* --- SYNC ANIMATION LOOP --- */
    setInterval(() => {
        const body = document.body;
        if(body.getAttribute('data-lang-state') === 'th') {
            body.setAttribute('data-lang-state', 'en');
        } else {
            body.setAttribute('data-lang-state', 'th');
        }
    }, 3000);

    /* --- INIT --- */
    window.onload = function() {
        adjustLayout();
        updateSig();
        updateTab('modeSelector');
        updateTab('previewTabs');
        document.querySelectorAll('input').forEach(el => checkPh(el));
        setTimeout(() => { updateTab('modeSelector'); updateTab('previewTabs'); }, 100);
    };

    window.onresize = function() { adjustLayout(); updateTab('modeSelector'); updateTab('previewTabs'); };
    window.onscroll = function() {
        const header = document.getElementById('stickyHeader');
        const guide = document.getElementById('guide-anchor');
        const btn = document.getElementById('floatGuideBtn');
        if (window.scrollY > 30) header.classList.add('scrolled'); else header.classList.remove('scrolled');
        if (guide && guide.getBoundingClientRect().top < window.innerHeight) btn.classList.add('hidden'); else btn.classList.remove('hidden');
    };

    function adjustLayout() { document.body.style.paddingTop = (document.querySelector('.main-header').offsetHeight + 30) + 'px'; }

    function updateTab(id) {
        const container = document.getElementById(id);
        const activeBtn = container.querySelector('.tab-btn.active');
        const slider = container.querySelector('.tab-slider');
        if (activeBtn && slider) { slider.style.width = activeBtn.offsetWidth + 'px'; slider.style.left = activeBtn.offsetLeft + 'px'; }
    }

    let currentMode = 'person';
    let currentTab = 'desktop';

    function setMode(mode, btnElement) {
        currentMode = mode;
        const container = document.getElementById('modeSelector');
        container.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btnElement.classList.add('active');
        updateTab('modeSelector');
        document.getElementById('formPerson').classList.toggle('active', mode === 'person');
        document.getElementById('formDept').classList.toggle('active', mode === 'dept');
        updateSig();
        document.querySelectorAll('input').forEach(el => checkPh(el));
    }

    function switchTab(tab, btnElement) {
        currentTab = tab;
        const container = document.getElementById('previewTabs');
        container.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btnElement.classList.add('active');
        updateTab('previewTabs');
        document.getElementById('previewDesktop').style.display = (tab === 'desktop') ? 'block' : 'none';
        document.getElementById('previewMobile').style.display = (tab === 'mobile') ? 'block' : 'none';
        const note = document.getElementById('noteText');
        note.innerHTML = (tab === 'desktop') ? '<strong>Desktop:</strong> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Outlook ‡∏ö‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå' : '<strong>Mobile:</strong> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iPhone/Android (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏ß‡∏ô)';
    }

    // --- PLACEHOLDER & WARNING TOGGLE ---
    function checkPh(input) {
        const ph = input.parentElement.querySelector('.custom-placeholder');
        
        // Position Warning Logic
        if(input.id === 'pPosition' && currentMode === 'person') {
            const warn = document.getElementById('warnPos');
            const secVal = document.getElementById('pSection').value;
            const deptVal = document.getElementById('pDepartment').value;
            
            // Show warning ONLY if Position is empty AND (Section OR Dept is filled)
            if(!input.value && (secVal || deptVal)) {
                warn.style.display = 'block';
                if(ph) ph.style.display = 'none';
            } else {
                warn.style.display = 'none';
                if(ph) ph.style.display = input.value ? 'none' : 'block';
            }
        } else {
            // General Logic
            if(ph) {
                const warn = input.parentElement.querySelector('.warning-msg');
                const isWarn = warn && warn.style.display === 'block';
                ph.style.display = (input.value || isWarn) ? 'none' : 'block';
            }
        }
    }

    function scrollToGuide() {
        document.getElementById('guide-anchor').scrollIntoView({behavior: 'smooth'});
        const firstBtn = document.getElementById('acc-item-1');
        if (!firstBtn.classList.contains('active')) firstBtn.click();
    }

    document.querySelectorAll('.accordion').forEach(btn => {
        btn.addEventListener('click', function() {
            this.classList.toggle('active');
            this.nextElementSibling.classList.toggle('show');
        });
    });

    function setGuideLang(lang) {
        document.getElementById('btnTh').classList.toggle('active', lang === 'th');
        document.getElementById('btnEn').classList.toggle('active', lang === 'en');
        document.querySelectorAll('[data-lang="th"]').forEach(e => e.style.display = lang === 'th' ? 'block' : 'none');
        document.querySelectorAll('[data-lang="en"]').forEach(e => e.style.display = lang === 'en' ? 'block' : 'none');
    }
    setGuideLang('th');

    // --- LOGIC: Mobile Format ---
    function formatSpecialPhone(input) {
        let clean = input.replace(/\D/g, '');
        if (clean.length === 10 && clean.startsWith('0')) return '+66 (0) ' + clean.substring(1, 5) + ' ' + clean.substring(5);
        if (clean.length === 9 && clean.startsWith('0')) return '+66 (0) ' + clean.substring(1, 5) + ' ' + clean.substring(5);
        return input;
    }

    // Validation (Empty = Clean State)
    function validateInput(el, type) {
        const val = el.value;
        const icon = el.parentElement.querySelector('.valid-icon');
        const warn = el.parentElement.querySelector('.warning-msg');
        
        if(!icon) return;

        // Reset first
        icon.style.display = 'none';
        if(warn && el.id !== 'pPosition') warn.style.display = 'none'; 
        el.classList.remove('input-error');

        // Check if empty -> CLEAN STATE (Return)
        if(!val) return; 

        let errorObj = null;
        if(type === 'en-name') {
            if(!/^[a-zA-Z]+(\s+[a-zA-Z]+)+$/.test(val)) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)", en: "Full name required (English)"};
        } 
        else if(type === 'th-name') {
            if(!/^[‡∏Å-‡πô]+(\s+[‡∏Å-‡πô]+)+$/.test(val)) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)", en: "Full name required (Thai)"};
        }
        else if(type === 'en') {
            if(/[\u0E00-\u0E7F]/.test(val)) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©", en: "English characters only"};
        } 
        else if(type === 'th') {
            if(/[a-zA-Z]/.test(val)) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢", en: "Thai characters only"};
        } 
        else if(type === 'email') {
            if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(val)) errorObj = {th: "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", en: "Invalid Email format"};
            if(/[\u0E00-\u0E7F]/.test(val)) errorObj = {th: "‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢", en: "No Thai characters"};
        } 
        else if(type === 'mobile') {
            const nums = val.replace(/\D/g, '');
            if(nums.length !== 10) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 10 ‡∏´‡∏•‡∏±‡∏Å", en: "Mobile number must be 10 digits"};
        }
        else if(type === 'tel') {
            const nums = val.replace(/\D/g, '');
            if(nums.length !== 9) errorObj = {th: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 9 ‡∏´‡∏•‡∏±‡∏Å", en: "Phone number must be 9 digits"};
        }

        if(errorObj) {
            if(warn) {
                warn.innerHTML = `<span class="th">‚ö†Ô∏è ${errorObj.th}</span><span class="en">‚ö†Ô∏è ${errorObj.en}</span>`;
                warn.style.display = 'block';
                const ph = el.parentElement.querySelector('.custom-placeholder');
                if(ph) ph.style.display = 'none';
            }
            el.classList.add('input-error');
        } else {
            icon.style.display = 'block';
        }
    }

    // --- MAIN UPDATE ---
    function updateSig() {
        const email = document.getElementById('inputEmail').value || 'example@bgrimmpower.com';
        
        // 1. NAME
        let enName, thName, nameHTML;
        if (currentMode === 'person') {
            const rawEn = document.getElementById('pNameEng').value || 'Somchai Jaidee';
            enName = rawEn.toUpperCase(); 
            thName = document.getElementById('pNameTh').value || '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ';
            
            // Allow checking of values
            validateInput(document.getElementById('pNameEng'), 'en-name');
            validateInput(document.getElementById('pNameTh'), 'th-name');
        } else {
            const rawEn = document.getElementById('dNameEng').value || 'Human Resources';
            enName = rawEn.toUpperCase(); 
            thName = document.getElementById('dNameTh').value || '';
            if(document.getElementById('dNameEng').value) validateInput(document.getElementById('dNameEng'), 'en');
        }
        nameHTML = enName;
        if(thName) nameHTML += ` <span style="color:#FF6727;">|</span> ${thName}`;
        document.getElementById('sigNameContent').innerHTML = nameHTML;

        // 2. POSITION
        if (currentMode === 'person') {
            const pos = document.getElementById('pPosition').value;
            const sec = document.getElementById('pSection').value;
            const mainDep = document.getElementById('pDepartment').value;
            checkPh(document.getElementById('pPosition')); 
            if(!pos) {
                document.getElementById('rowPosition').style.display = 'none';
            } else {
                document.getElementById('rowPosition').style.display = 'table-row';
                let deptStr = '';
                if(sec && mainDep) deptStr = `${sec}, ${mainDep}`;
                else if(sec) deptStr = sec;
                else if(mainDep) deptStr = mainDep;
                let posHTML = pos;
                if(deptStr) posHTML += ` <span style="color:#63666F;">|</span> ${deptStr}`;
                document.getElementById('prevPos').innerHTML = posHTML;
            }
        } else {
            document.getElementById('rowPosition').style.display = 'none';
        }

        // PHONES
        const rawMob = document.getElementById('inputMobile').value;
        const rawTel = document.getElementById('inputTel').value;
        validateInput(document.getElementById('inputMobile'), 'mobile');
        validateInput(document.getElementById('inputTel'), 'tel');

        let fMob = '', fTel = '';
        if(rawMob && rawMob.replace(/\D/g,'').length === 10) fMob = formatSpecialPhone(rawMob);
        if(rawTel && rawTel.replace(/\D/g,'').length === 9) fTel = formatSpecialPhone(rawTel);

        const wrapMob = document.getElementById('wrapMob');
        const wrapTel = document.getElementById('wrapTel');
        const lnkMob = document.getElementById('linkMobile');

        // UNLOCKED: Show Mobile if valid
        if (fMob) {
            wrapMob.style.display = 'inline';
            lnkMob.innerText = fMob;
            lnkMob.href = 'tel:' + fMob.replace(/[^0-9+]/g, '');
        } else {
            wrapMob.style.display = 'none';
        }

        if (fTel) {
            let telHTML = '';
            if (fMob) telHTML += ` <span style="color:#63666F;">|</span> `;
            telHTML += `<strong>Phone</strong> <a href="tel:${fTel.replace(/[^0-9+]/g, '')}" class="sig-link">${fTel}</a>`;
            wrapTel.innerHTML = telHTML;
            wrapTel.style.display = 'inline';
        } else {
            wrapTel.style.display = 'none';
        }

        if (!fMob && !fTel) document.getElementById('rowPhones').style.display = 'none';
        else document.getElementById('rowPhones').style.display = 'table-row';

        document.getElementById('linkEmail').innerText = email;
        document.getElementById('linkEmail').href = 'mailto:' + email;
        validateInput(document.getElementById('inputEmail'), 'email');

        let mText = `--\n\n${enName}`;
        if(thName) mText += ` | ${thName}`;
        mText += `\n`;
        if(currentMode === 'person' && document.getElementById('rowPosition').style.display !== 'none') {
             mText += document.getElementById('prevPos').innerText.replace('|', '|') + `\n`;
        }
        mText += `B.Grimm Power PCL | Dr. Gerhard Link Building, 5 Krungthepkreetha Road, Bangkok 10240, Thailand\n`;
        if(fMob) mText += `Mobile ${fMob}`;
        if(fMob && fTel) mText += ` | `;
        if(fTel) mText += `Phone ${fTel}`;
        if(fMob || fTel) mText += `\n`;
        mText += `Email ${email} | www.bgrimmpower.com`;
        document.getElementById('mobContent').innerText = mText;
    }
    
    document.querySelectorAll('input').forEach(i => {
        i.addEventListener('input', function(){ this.classList.add('touched'); checkPh(this); updateSig(); });
    });
</script>

</body>
</html>
